---
layout: post
category: ['小程序']
title: 微信小程序
---
# 微信小程序-Sublime Text3插件

1. 修改文件类型

	`wxml设置文件类型为html`

	`wxss设置文件类型为css`

	`js设置文件类型为javascript`

	`json设置文件类型为json`

2. 安装插件

`下载地址:` <https://github.com/Abbotton/weapp-snippet-for-sublime-text-2-3>

解压之后把这个 `weappSnippet` 文件夹放到sublime text安装文件Packages/User 下,重启!



# 在app.js中给全局变量赋值(更改全局变量的值)
```javascript
var that = this

that.globalData.userInfo="你得到的值";

// 在其他js中给全局变量赋值
//获取应用实例
var app = getApp()
app.globalData.getUserInfoFail="你的值";
```

# 调用全局函数和函数的复用
在app.js的App({})中定义的`数据`或`函数`都是`全局的`

在js页面中可以通过

var app = getApp();

app.function/key的方式调用

不过我们没有必要再app.js中定义全局函数,微信已经帮我们定义了一个模块化的思想

`文档:`

<https://mp.weixin.qq.com/debug/wxadoc/dev/framework/app-service/module.html>

`eg:`

```javascript
//util.js
/**
 * 处理业务逻辑
 */
function formatTime(date) {
  var year = date.getFullYear()
  var month = date.getMonth() + 1
  var day = date.getDate()

  var hour = date.getHours()
  var minute = date.getMinutes()
  var second = date.getSeconds()


  return [year, month, day].map(formatNumber).join('/') + ' ' + [hour, minute, second].map(formatNumber).join(':')
}

function formatNumber(n) {
  n = n.toString()
  return n[1] ? n : '0' + n
}

// 获取用户所在地址
function getLocation(){

  return "我在人民广场吃炸鸡!"
}

/**
 * 模块化导出暴露接口
 */
module.exports = {
  formatTime: formatTime,
  getLocation: getLocation
}

```

```javascript
//index.js
// 引入
var utils = require("../../utils/util.js")

Page({
  data: {
	// ...,
    location:"你在哪里呦!!",
  },


  // 获取地址
  modal:function(){
    var that = this

    wx.showModal({
     title: "提示",
     content: "确定后会更改location",

     success: function(res) {
      if (res.confirm) {
        that.setData({
          // 这样获取值
          location: utils.getLocation(),
        })
      }
     },

     fail: function(res){
      console.log("你家弹窗呢?");
     }

    })
  },
})
```
